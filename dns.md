域名系统（Domain Name System）
=============================

## 1 DNS模型

人们喜欢便于记忆的主机名标识方式，而路由器则喜欢定长的、有着层次
结构的IP地址。为了折衷这些不同的偏好，我们需要一种能够进行主机名
到IP地址转换的目录服务。这就是域名系统的主要任务。
DNS是：（1）一个由分层的DNS服务器实现的分布式数据库；（2）一个使得
主机能够查询分布式数据库的应用层协议。
DNS服务器通常是运行BIND（Berkeley Internet Name Domain）软件的UNIX
机器。DNS协议默认运行在UDP之上，使用53号端口。

### 1.1 域名结构

### 1.2 DNS服务器体系结构

**DNS服务器**的体系结构一般分为三级：根服务器、顶级域DNS服务器、
权限域服务器。在此体系之外，还有另一类重要的DNS，称为本地DNS服务器。
L-DNS一般由ISP或其他厂商提供，它们都是递归DNS，返回的结果为非权威应答。

为了提高域名服务器的可靠性,DNS域名服务器都把数据复制到几个域名服务器
来保存，其中的一个是主域名服务器（master name server），其他的是
辅助域名服务器(secondary name server)。当主域名服务器出现故障时，辅助
域名服务器可以保证DNS的查询工作不会中断。主域名服务器定期把数据复制到
辅助域名服务器中，而更改数据只能在主域名服务器中进行。这样就保证了
数据的一致性。

### 1.3 DNS的两种查询方式

### 1.4 DNS一般解析过程

- 在浏览器中输入域名www.baidu.com，浏览器会抽取URL中的域名字段，
  并把这个字段传送给DNS应用的客户端。DNS客户端会先调用系统函数，
  检查自己的本地hosts中是否有这个网址的映射关系，如果有，就直接
  调用这个IP映射，完成域名解析。

- 如果hosts中没有这个域名映射，则查找本地服务器DNS缓存是否存在
  这个网址的映射关系，如果有，直接返回结果，完成域名映射。

- 如果hosts中和本地DNS缓存中都没有相应的网址映射关系，那么DNS
  客户端会首先查找tcp/ip参数设置中的

- 
## 2 DNS实现

### 2.1 DNS报文

### 2.2 常用工具

## 3 DNS攻击及防御

## 一、**DNS**解析一般过程

###１、 DNS 服务器体系结构


###2、解析过程（以ｗｗｗ．ｂａｉｄｕ．ｃｏｍ为例）





2、如果hosts里没有这个域名的映射，则查找本地DNS解析器缓存，是否有这个网址映射关系，如果有，直接返回，完成域名解析。

3、如果hosts与本地DNS解析器缓存都没有相应的网址映射关系，首先会找TCP/ip参数中设置的首选DNS服务器，在此我们叫它本地DNS服务器，此服务器收到查询时，如果要查询的域名，包含在本地配置区域资源中，则返回解析结果给客户机，完成域名解析，此解析具有权威性。

4、如果要查询的域名，不由本地DNS服务器区域解析，但该服务器已缓存了此网址映射关系，则调用这个IP地址映射，完成域名解析，此解析不具有权威性。

5、如果本地DNS服务器本地区域文件与缓存解析都失效，则根据本地DNS服务器的设置（是否设置转发器）进行查询，如果未用转发模式，本地DNS就把请求发至13台根DNS，根DNS服务器收到请求后会判断这个域名(.com)是谁来授权管理，并会返回一个负责该顶级域名服务器的一个IP。本地DNS服务器收到IP信息后，将会联系负责.com域的这台服务器。这台负责.com域的服务器收到请求后，如果自己无法解析，它就会找一个管理.com域的下一级DNS服务器地址(http://qq.com)给本地DNS服务器。当本地DNS服务器收到这个地址后，就会找http://qq.com域服务器，重复上面的动作，进行查询，直至找到www . qq .com主机。

6、如果用的是转发模式，此DNS服务器就会把请求转发至上一级DNS服务器，由上一级服务器进行解析，上一级服务器如果不能解析，或找根DNS或把转请求转至上上级，以此循环。不管是本地DNS服务器用是是转发，还是根提示，最后都是把结果返回给本地DNS服务器，由此DNS服务器再返回给客户机。 

------

二、DNS 报文
==========

------


三、DNS 记录
===========

------

> Written with [StackEdit](https://stackedit.io/).
